# 🏗️ LangChain을 활용한 AI 워크플로우 오케스트레이션 보고서

---

## 1. 개요
본 보고서는 우리 프로젝트에서 **LangChain** 프레임워크를 도입하여 복잡한 AI 추론 과정을 정형화하고, 유지보수가 용이한 파이프라인(Chain)을 구축한 사례를 기술한다.

---

## 2. LangChain 도입 배경 및 핵심 모듈

### 2.1 LangChain이란?
LLM(대규모 언어 모델)과 외부 데이터(이력서 DB)를 결합하여 복잡한 애플리케이션을 쉽게 개발할 수 있도록 돕는 오픈소스 프레임워크이다.

### 2.2 프로젝트 활용 핵심 모듈
*   **PromptTemplate**: 페르소나와 지침을 체계적으로 관리.
*   **VectorStore (PGVector)**: 벡터 데이터 저장 및 유사도 검색 연동.
*   **Retriever**: 쿼리에 적합한 문맥(Context)을 추출하는 객체.
*   **LCEL (LangChain Expression Language)**: 파이프라인(| 연산자) 구성.

---

## 3. 현 프로젝트 적용 사례 (코드 및 워크플로우)

### 3.1 LCEL 기반의 추론 파이프라인 (tasks/question_generator.py)
코드의 가독성을 높이고 데이터 흐름을 명확하게 하기 위해 LCEL을 적용했다.

```python
# [LCEL 파이프라인 구성 사례]
llm = get_exaone_llm()
prompt = PromptTemplate.from_template(PROMPT_TEMPLATE)

# 1. 프롬프트 -> 2. LLM 추론 -> 3. 문자열 파싱 (체인 구성)
chain = prompt | llm | StrOutputParser()

# 체인 호출
final_content = chain.invoke({
    "context": context_text,
    "stage_name": next_stage['display_name'],
    "company_ideal": company_ideal,
    ...
})
```

### 3.2 Retriever 객체 활용 (tasks/rag_retrieval.py)
단순 검색을 넘어, 다른 LangChain 모듈과 결합 가능한 `Retriever`를 생성하여 추상화 수준을 높였다.

```python
# [Retriever 생성 및 활용 사례]
def get_retriever(resume_id=1, top_k=10):
    vector_store = get_vector_store("resume_all_embeddings")
    
    # 필터가 내장된 Retriever 반환
    return vector_store.as_retriever(
        search_kwargs={
            "k": top_k,
            "filter": {"resume_id": resume_id}
        }
    )
```

---

## 4. 종합 평가 및 강점

| 항목 | 일반적인 API 호출 방식 | LangChain 기반 방식 (우리 프로젝트) |
| :--- | :--- | :--- |
| **코드 구조** | 복잡한 조건문과 문자열 연산 | **파이프라인(|) 중심의 선언적 구조** |
| **모델 교체** | API 호출 로직 전체 수정 필요 | **LLM 객체만 교체하면 즉시 연동** |
| **DB 연동** | 수동으로 임베딩 및 SQL 작성 | **VectorStore 모듈로 자동화** |
| **재사용성** | 낮음 | **Chain 조립을 통해 높음** |

---

## 5. 결론
우리 프로젝트는 LangChain을 도입함으로써 **"이력서 검색(Retrieval) -> 질문 생성(Generation) -> 응답 정제(Post-processing)"**라는 복잡한 RAG 일련의 과정을 하나의 유기적인 시스템으로 통합하였으며, 향후 다른 LLM(GPT-4 등)으로의 전환 시에도 최소한의 코드 수정만으로 대응할 수 있는 유연성을 확보하였다.

---

**[작성 위치]**
*   파일 경로: `C:\big20\Big20_aI_interview_project\파이널_진행보고서\랭체인\04.랭체인-워크플로우-오케스트레이션.md`
