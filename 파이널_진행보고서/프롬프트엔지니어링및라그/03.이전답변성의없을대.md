# [리포트] 이전 답변의 성의 없는 입력(무의미한 텍스트) 대응 및 할루시네이션 방지 전략

본 보고서는 지원자가 "ㄴㅇㄹㄴㅇㄹ"과 같이 무의미한 답변을 했을 때, AI가 이전 단계의 컨텍스트(예: SQLD 자격증)를 오남용하여 가공의 요약을 생성하는 문제를 분석하고 이에 대한 기술적 해결책을 제시합니다.

---

## 1. 오류 원인 분석 및 본질

### **1.1 실제 발생 상황 (로직 분석)**
`question_generator.py` 코드(라인 316~322 부근)에 따르면 질문 생성 시 다음과 같은 흐름이 발생합니다.

*   **단계 상황**: 4번 단계(`skill_followup`)는 3번(`skill`) 질문에 대한 꼬리질문입니다.
*   **데이터 구성**: 인터뷰의 일관성을 위해 시스템은 `context_text`를 생성합니다.
*   **컨텍스트 주입**: 4번 단계가 `certification` 카테고리와 연관되어 있어, 시스템이 자동으로 **"지원자가 보유한 자격증 목록: SQLD"**라는 텍스트를 `context_text`에 넣게 됩니다.
*   **답변 결합**: 여기에 지원자의 실제 답변인 **"ㄴㅇㄹㄴㅇㄹ"**이 뒤에 붙어 AI에게 전달됩니다.

**[AI가 전달받는 최종 데이터(Prompt)]**
> **[문맥 정보]**  
> 지원자가 보유한 자격증 목록: SQLD  
> [지원자의 답변]: ㄴㅇㄹㄴㅇㄹ  
>
> **[지시사항]**  
> 위 내용을 요약하고 꼬리질문을 해라.

### **1.2 왜 '오남용'인가? (AI의 추론 오류)**
AI(LLM)는 기본적으로 **"말이 되게 만드는 기계"**입니다. 입력된 "정보 1(SQLD)"과 "정보 2(ㄴㅇㄹㄴㅇㄹ)"가 모순될 때, AI는 "요약하라"는 지시를 지키기 위해 필사적으로 노력합니다.

*   **추론 과정**: "지원자가 의미 없는 말을 했지만, 문맥에 'SQLD 자격증'이 있으니 아마 자격증에 대해 말하고 싶었던 게 아닐까?"라고 스스로 소설을 써서 **허구 요약**을 생성합니다.
*   **결과**: "SQLD 자격증을 통해... 말씀해 주셨군요"라는 명백한 할루시네이션이 발생합니다.

### **1.3 문제의 본질**
4번 질문을 만들 때, 3번에서 쓰인 '자격증 정보'가 여전히 AI의 머릿속(Context)에 남아 있는 상태에서 답변이 부실할 경우, AI가 답변 내용 대신 **컨텍스트의 강한 키워드만 보고 엉뚱한 결론**을 내리는 구조적 이슈입니다.

---

## 2. 개선 전략 제언

위 문제를 해결하기 위해 시스템적 방어막(Guard Layer)과 프롬프트 격리 전략을 적용합니다.

### **전략 1: 무의미한 입력 사전 차단 (Guard Layer)**
LLM 호출 전에 서버 레벨에서 자음/모음 나열, 너무 짧은 텍스트 등을 감지하여 차단합니다.
```python
import re
def is_meaningless(text: str) -> bool:
    if not text or len(text.strip()) < 5: return True
    if re.fullmatch(r'[ㄱ-ㅎㅏ-ㅣ\s]+', text): return True
    return False
```

### **전략 2: 요약 지시어 완화 (Soft Instruction)**
"반드시 요약하십시오"라는 강박적 지시 대신, "답변에 의미 있는 내용이 있을 경우에만 요약하며 시작하십시오"라고 지침을 변경합니다.

### **전략 3: 컨텍스트 격리 (Context Isolation)**
무의미한 답변이 감지될 경우, AI에게 이전 단계의 정보(SQLD 등)를 아예 보여주지 않음으로써 환각의 재료를 원천 차단합니다.

### **전략 4: 요약 조건부 분기 처리**
입력이 유효하지 않을 때 AI에게 전달되는 임무를 "요약 및 꼬리질문"에서 **"재답변 요청 및 정중한 가이드"**로 즉시 교체합니다.

---

## 3. 기대 효과

| 항목 | 개선 전 | 개선 후 |
| :--- | :--- | :--- |
| **환각 발생** | 높음 (억지 요약) | 낮음 (재질문 유도) |
| **컨텍스트 사용** | 무차별적 주입 | 답변 질에 따른 선택적 주입 |
| **사용자 경험** | 시스템이 이상하다고 느낌 | 시스템이 내 말을 이해 못 했음을 인지 |

---
**보고서 작성**: Antigravity AI Engine Specialist  
**상태**: 개선 전략 수립 및 코드 반영 대기 중
