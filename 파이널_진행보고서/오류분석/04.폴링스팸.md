# 🚀 [Troubleshooting] 프론트엔드 API 폴링 스팸 (Polling Spam) 이슈

## 🚨 현상

백엔드 서버 로그에 `GET /interviews/{id}/questions` 요청이 비정상적으로 짧은 간격으로 무수히 반복적으로 기록되는 현상 발생.

**로그 예시:**
> `GET /interviews/133/questions HTTP/1.1 200 OK` (1초~2초 간격 무한 반복)

---

## 🔍 원인 분석

React 프론트엔드(`App.jsx`) 파일 분석 결과, 다음 **두 가지 시나리오**에서 매우 짧은 주기의 API 호출이 발생하고 있습니다.

### 1. TTS(음성) 파일 대기 폴링 (`useEffect`)
*   AI가 면접 질문 텍스트는 즉시 생성하지만, 음성(WAV) 파일은 AI 워커가 생성하는 데 몇 초의 시간이 더 소요됩니다.
*   프론트엔드에서는 현재 질문의 `audio_url`이 없을 경우, 음성이 준비되었는지 확인하기 위해 **2초마다** 전체 질문 리스트를 다시 조회합니다.

### 2. 다음 AI 질문 생성 대기 폴링 (`nextQuestion`)
*   사용자가 답변을 마친 후 [다음 질문] 버튼을 누르면, AI 워커가 이전 답변을 분석해 '꼬리질문'을 생성합니다.
*   이 생성 과정 동안 새로운 질문 데이터가 생겼는지 확인하기 위해 **2초마다** 루프를 돌며 API를 호출합니다.

---

## 🛠️ 해결 방안: 폴링 주기를 2초에서 4초로 상향

가장 안전하고 확실한 부하 감소를 위해 폴링 간격을 **2초(2000ms) ➡ 4초(4000ms)**로 상향 조정하였습니다.

### 📍 수정 내용 (`App.jsx`)

```javascript
// 1. TTS 폴링 간격 수정 (Line 731)
- }, 2000); // 2초 간격으로 확인
+ }, 4000); // 4초 간격으로 확인 (서버 부하 감소)

// 2. 다음 질문 대기 폴링 간격 수정 (Line 771)
- await new Promise(r => setTimeout(r, 2000));
+ await new Promise(r => setTimeout(r, 4000)); // 4초 간격 (서버 부하 감소)
```

**기대 효과:**
*   서버에 가해지는 요청 부하가 **50% 감소**합니다.
*   사용자 체감 대기 시간(UX)은 수 초 차이로 크지 않으면서도 시스템 안정성을 확보할 수 있습니다.

---

## 📁 관련 파일

| 파일 | 역할 |
|------|------|
| `frontend/src/App.jsx` | 면접 진행 상태 관리 및 API 폴링 로직 구현 (수정 완료) |
| `frontend/src/api/interview.js` | `getInterviewQuestions` API 함수 정의 |
| `backend-core/routes/interviews.py` | 인터뷰 및 질문 조회 엔드포인트 제공 |

---

## 🚀 향후 개선 과제 (Long-term)

장기적으로는 폴링(Polling) 방식 대신 서버에서 작업 완료를 알려주는 **푸시(Push)** 방식을 도입하는 것을 추천합니다.

1.  **WebSocket 보강:** 이미 구현된 AI 스트리밍 웹소켓을 통해 `tts_ready` 또는 `question_created` 이벤트를 서버로부터 전송받습니다.
2.  **SSE(Server-Sent Events) 도입:** 단방향 통지(음성 생성 완료 등)의 경우 효율적입니다.
3.  **React Query 활용:** `refetchInterval` 등을 통해 캐시 기반 폴링을 관리하면 더 체계적인 제어가 가능합니다.

---

*작성일: 2026-02-28 / 담당자: AI Assistant*
