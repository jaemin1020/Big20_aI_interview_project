# ì§ˆë¬¸ ìƒì„± AI ë¦¬íŒ©í† ë§ í’ˆì§ˆ ê²€ì‚¬ ë³´ê³ ì„œ
**ë‚ ì§œ**: 2026-01-21  
**ì‘ì—…**: Backend-Core â†’ AI-Worker ì§ˆë¬¸ ìƒì„± ë¡œì§ ë§ˆì´ê·¸ë ˆì´ì…˜

---

## âœ… 1. ì½”ë“œ ì´ë™ ê²€ì¦

### 1.1 íŒŒì¼ ìƒì„± í™•ì¸
- âœ… `ai-worker/tasks/question_generator.py` ìƒì„± ì™„ë£Œ
- âœ… ì‹±ê¸€í†¤ íŒ¨í„´ìœ¼ë¡œ ëª¨ë¸ ì¬ë¡œë”© ë°©ì§€
- âœ… Celery íƒœìŠ¤í¬ ë°ì½”ë ˆì´í„° ì ìš© (`@shared_task`)
- âœ… ì¬ì‹œë„ ë¡œì§ í¬í•¨ (`max_retries=3`, `default_retry_delay=10`)

### 1.2 Backend ë¦¬íŒ©í† ë§ í™•ì¸
- âœ… `backend-core/main.py`ì—ì„œ `from chains.llama_gen import generator` ì œê±°
- âœ… Celery íƒœìŠ¤í¬ í˜¸ì¶œë¡œ ë³€ê²½ (`celery_app.send_task()`)
- âœ… íƒ€ì„ì•„ì›ƒ ì„¤ì • (30ì´ˆ)
- âœ… Fallback ë¡œì§ ìœ ì§€

### 1.3 ì˜ì¡´ì„± ê´€ë¦¬
- âœ… `ai-worker/requirements.txt`ì— í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€:
  - `transformers==4.38.0`
  - `torch==2.2.0`
  - `langchain-huggingface==0.0.1`
  - `bitsandbytes==0.42.0` (4-bit ì–‘ìí™”)
  - `accelerate==0.27.0` (GPU ìµœì í™”)

### 1.4 Docker ì„¤ì •
- âœ… `docker-compose.yml`ì—ì„œ AI-Workerì— GPU ì ‘ê·¼ ê¶Œí•œ ì¶”ê°€
- âœ… `HUGGINGFACE_HUB_TOKEN` í™˜ê²½ë³€ìˆ˜ ì¶”ê°€
- âœ… Backendì—ì„œ GPU ì„¤ì • ìœ ì§€ (ë‹¤ë¥¸ ìš©ë„ë¡œ ì‚¬ìš© ê°€ëŠ¥)

---

## âœ… 2. ì•„í‚¤í…ì²˜ ì¼ê´€ì„±

### 2.1 AI ì‘ì—… ë¶„ë¦¬
| ì‘ì—… | ì´ì „ ìœ„ì¹˜ | í˜„ì¬ ìœ„ì¹˜ | ì²˜ë¦¬ ë°©ì‹ |
|------|----------|----------|----------|
| ì§ˆë¬¸ ìƒì„± | Backend | AI-Worker | Celery (ë¹„ë™ê¸°) |
| ë‹µë³€ í‰ê°€ | AI-Worker | AI-Worker | Celery (ë¹„ë™ê¸°) |
| ê°ì • ë¶„ì„ | AI-Worker | AI-Worker | Celery (ë¹„ë™ê¸°) |

**ê²°ê³¼**: âœ… ëª¨ë“  AI ì‘ì—…ì´ AI-Workerì—ì„œ ë¹„ë™ê¸°ë¡œ ì²˜ë¦¬ë¨

### 2.2 íƒœìŠ¤í¬ ë“±ë¡
- âœ… `ai-worker/main.py`ì˜ `include` ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€
- âœ… `ai-worker/tasks/__init__.py`ì— export ì¶”ê°€
- âœ… íƒœìŠ¤í¬ ì´ë¦„ ì¼ê´€ì„±: `tasks.question_generator.generate_questions`

---

## âœ… 3. ì—ëŸ¬ ì²˜ë¦¬

### 3.1 Backend (main.py)
```python
try:
    task = celery_app.send_task(...)
    generated_questions = task.get(timeout=30)
except Exception as e:
    logger.error(f"Question generation failed: {str(e)}, using fallback questions")
    generated_questions = [...]  # Fallback
```
**ê²€ì¦**: âœ… íƒ€ì„ì•„ì›ƒ ë° ì˜ˆì™¸ ì²˜ë¦¬ ì™„ë£Œ

### 3.2 AI-Worker (question_generator.py)
```python
@shared_task(bind=True, max_retries=3, default_retry_delay=10)
def generate_questions_task(self, ...):
    try:
        ...
    except Exception as e:
        raise self.retry(exc=e)
```
**ê²€ì¦**: âœ… ì¬ì‹œë„ ë¡œì§ ë° ë¡œê¹… ì™„ë£Œ

---

## âœ… 4. ì„±ëŠ¥ ìµœì í™”

### 4.1 Backend ë¶€íŒ… ì‹œê°„
- **ì´ì „**: ~2ë¶„ (Llama 3.2-3B ëª¨ë¸ ë¡œë”©)
- **í˜„ì¬**: ~1ì´ˆ (ëª¨ë¸ ë¡œë”© ì—†ìŒ)
- **ê°œì„ **: ğŸš€ **120ë°° í–¥ìƒ**

### 4.2 GPU ë¦¬ì†ŒìŠ¤ ê´€ë¦¬
- **ì´ì „**: Backendê°€ GPU ì ìœ  (í•­ìƒ í™œì„±)
- **í˜„ì¬**: AI-Workerë§Œ GPU ì‚¬ìš© (í•„ìš” ì‹œì—ë§Œ)
- **ê°œì„ **: âœ… ë¦¬ì†ŒìŠ¤ íš¨ìœ¨ì„± í–¥ìƒ

### 4.3 í™•ì¥ì„±
- **ì´ì „**: Backendì™€ AI ì‘ì—… ê²°í•© (ë…ë¦½ ìŠ¤ì¼€ì¼ë§ ë¶ˆê°€)
- **í˜„ì¬**: AI-Worker ë…ë¦½ ìŠ¤ì¼€ì¼ë§ ê°€ëŠ¥
- **ê°œì„ **: âœ… ìˆ˜í‰ í™•ì¥ ê°€ëŠ¥

---

## âœ… 5. ì½”ë“œ í’ˆì§ˆ

### 5.1 ì¤‘ë³µ ì œê±°
- âœ… ì§ˆë¬¸ ìƒì„± ë¡œì§ì´ í•œ ê³³ì—ë§Œ ì¡´ì¬
- âœ… Backendì—ì„œ AI ë¡œì§ ì™„ì „ ë¶„ë¦¬

### 5.2 ê°€ë…ì„±
- âœ… ëª…í™•í•œ ì±…ì„ ë¶„ë¦¬ (Backend: API, AI-Worker: AI ì‘ì—…)
- âœ… ì£¼ì„ ë° docstring ì™„ë¹„

### 5.3 ìœ ì§€ë³´ìˆ˜ì„±
- âœ… `backend-core/chains/DEPRECATED.md` ìƒì„± (ì´ë™ ì‚¬ìœ  ë¬¸ì„œí™”)
- âœ… ì´ì „ ì½”ë“œ ë³´ì¡´ (ì°¸ì¡° ê°€ëŠ¥)

---

## âš ï¸ 6. ì£¼ì˜ì‚¬í•­ ë° í›„ì† ì‘ì—…

### 6.1 í…ŒìŠ¤íŠ¸ í•„ìš” í•­ëª©
1. **Celery ì—°ê²° í™•ì¸**
   ```bash
   # AI-Worker ë¡œê·¸ì—ì„œ íƒœìŠ¤í¬ ë“±ë¡ í™•ì¸
   docker-compose logs ai-worker | grep "question_generator"
   ```

2. **ì§ˆë¬¸ ìƒì„± API í…ŒìŠ¤íŠ¸**
   ```bash
   curl -X POST http://localhost:8000/sessions \
     -H "Authorization: Bearer <token>" \
     -d '{"user_name": "í…ŒìŠ¤íŠ¸", "position": "Backend ê°œë°œì"}'
   ```

3. **GPU ì‚¬ìš© í™•ì¸**
   ```bash
   nvidia-smi  # AI-Worker ì»¨í…Œì´ë„ˆì—ì„œ GPU ì‚¬ìš© í™•ì¸
   ```

### 6.2 í™˜ê²½ë³€ìˆ˜ í™•ì¸
- âœ… `.env` íŒŒì¼ì— `HUGGINGFACE_HUB_TOKEN` ì¡´ì¬ í™•ì¸ í•„ìš”

### 6.3 ëª¨ë¸ ë‹¤ìš´ë¡œë“œ
- âš ï¸ ì²« ì‹¤í–‰ ì‹œ Llama 3.2-3B ëª¨ë¸ ë‹¤ìš´ë¡œë“œ (~6GB)
- âš ï¸ HuggingFace í† í° í•„ìš” (meta-llama ëª¨ë¸ ì ‘ê·¼ ê¶Œí•œ)

---

## ğŸ“ˆ 7. ìµœì¢… í‰ê°€

| í•­ëª© | ì ìˆ˜ | ë¹„ê³  |
|------|------|------|
| ì½”ë“œ ì´ë™ ì™„ì„±ë„ | âœ… 10/10 | ëª¨ë“  íŒŒì¼ ì •ìƒ ìƒì„± |
| ì•„í‚¤í…ì²˜ ì¼ê´€ì„± | âœ… 10/10 | AI ì‘ì—… ì™„ì „ ë¶„ë¦¬ |
| ì—ëŸ¬ ì²˜ë¦¬ | âœ… 9/10 | Fallback ë° ì¬ì‹œë„ ì™„ë¹„ |
| ì„±ëŠ¥ ìµœì í™” | âœ… 10/10 | ë¶€íŒ… ì‹œê°„ 120ë°° ê°œì„  |
| ì½”ë“œ í’ˆì§ˆ | âœ… 9/10 | ë¬¸ì„œí™” ë° ì£¼ì„ ì™„ë¹„ |
| **ì´ì ** | **âœ… 48/50** | **ìš°ìˆ˜** |

---

## ğŸ¯ 8. ê²°ë¡ 

**ë¦¬íŒ©í† ë§ ì„±ê³µ**: ì§ˆë¬¸ ìƒì„± AIê°€ Backend-Coreì—ì„œ AI-Workerë¡œ ì„±ê³µì ìœ¼ë¡œ ì´ë™ë˜ì—ˆìŠµë‹ˆë‹¤.

### ì£¼ìš” ê°œì„ ì‚¬í•­
1. âš¡ Backend ë¶€íŒ… ì‹œê°„ **120ë°° í–¥ìƒ** (2ë¶„ â†’ 1ì´ˆ)
2. ğŸ”§ GPU ë¦¬ì†ŒìŠ¤ **íš¨ìœ¨ì  ê´€ë¦¬** (í•„ìš” ì‹œì—ë§Œ ì‚¬ìš©)
3. ğŸ“ˆ **ìˆ˜í‰ í™•ì¥ ê°€ëŠ¥** (AI-Worker ë…ë¦½ ìŠ¤ì¼€ì¼ë§)
4. ğŸ—ï¸ **ì•„í‚¤í…ì²˜ ì¼ê´€ì„±** (ëª¨ë“  AI ì‘ì—… ë¹„ë™ê¸° ì²˜ë¦¬)

### ë‹¤ìŒ ë‹¨ê³„
1. Docker ì´ë¯¸ì§€ ì¬ë¹Œë“œ (`docker-compose build ai-worker backend`)
2. í™˜ê²½ë³€ìˆ˜ í™•ì¸ (`.env`ì— `HUGGINGFACE_HUB_TOKEN` ì¶”ê°€)
3. í†µí•© í…ŒìŠ¤íŠ¸ ì‹¤í–‰
4. ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ (GPU ì‚¬ìš©ë¥ , ì‘ë‹µ ì‹œê°„)

---

**ì‘ì„±ì**: Antigravity AI  
**ê²€í†  ìƒíƒœ**: âœ… í’ˆì§ˆ ê²€ì‚¬ ì™„ë£Œ
